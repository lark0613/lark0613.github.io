<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>笔记页 - Lark</title>
  <link rel="stylesheet" href="css/style.css">
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/vs2015.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
</head>

<body>
  <nav class="navbar">
    <div class="nav-left">Lark 个人主页</div>
    <div class="nav-right">
      <a href="index.html">首页</a>
      <a href="startpage.html">启动台</a>
      <a href="about.html">博客</a>
      <a href="notes.html">笔记页</a>
    </div>
  </nav>

  <div class="notes-container">
    <h1>我的学习笔记</h1>
    <div id="note-list"></div>
    <div id="note-content" style="display:none;"></div>
  </div>

  <button id="theme-toggle" onclick="toggleTheme()">
    <i class="fas fa-moon" id="theme-icon"></i>
  </button>

  <script>
    // 自动读取 notes 文件夹所有 .md 文件（改这里就行！）
    const REPO = "lark0613/lark0613.github.io";   // ← 改成你的用户名和仓库名

    fetch(`https://api.github.com/repos/${REPO}/contents/notes`)
      .then(r => r.json())
      .then(files => {
        const mdFiles = files.filter(f => f.name.endsWith('.md')).sort((a, b) => a.name.localeCompare(b.name));
        const list = document.getElementById('note-list');
        const content = document.getElementById('note-content');

        mdFiles.forEach(f => {
          const div = document.createElement('div');
          div.className = 'note-item';
          div.innerHTML = `<a href="javascript:void(0)">${f.name.replace('.md', '').replace(/-/g, ' ')}</a>`;
          div.onclick = () => {
            fetch(f.download_url).then(r => r.text()).then(md => {
              content.innerHTML = `<button onclick="back()" class="back-btn">返回列表</button><article class="note-article">${marked.parse(md)}</article>`;
              content.style.display = 'block';
              list.style.display = 'none';
              document.querySelectorAll('pre code').forEach(hljs.highlightElement);
            });
          };
          list.appendChild(div);
        });
      });

    window.back = () => {
      document.getElementById('note-content').style.display = 'none';
      document.getElementById('note-list').style.display = 'block';
    };

    function toggleTheme() {
      document.body.classList.toggle('light');
      const isLight = document.body.classList.contains('light');
      document.getElementById('theme-icon').className = isLight ? 'fas fa-sun' : 'fas fa-moon';
      localStorage.setItem('theme', isLight ? 'light' : 'dark');
    }
    if (localStorage.getItem('theme') === 'light') {
      document.body.classList.add('light');
      document.getElementById('theme-icon').className = 'fas fa-sun';
    }
  </script>
</body>

</html>